---
title: "对实验2数据的小波分析"
output: html_notebook
---

读取一个被试的数据
```{r}
library(readr)
total_data <- read_delim("~/Dropbox/毕业设计/实验数据/仪器数据/txtfile/test2/convert/sub10/sub10.TXT", 
    "\t", escape_double = FALSE, trim_ws = TRUE, 
    skip = 34)

one_wave <- total_data[,c(1,5)]
```
data.frame(
    X1.44051748238150e.06 = c(7.23163071696294e-06, -8.57721308067518e-06),
   X.4.58098089567796e.06 = c(5.5021138722312e-06, 3.04725792522511e-06),
   X.5.34630366334278e.07 = c(1.99209389430215e-05, 1.75377427291559e-07),
   X.4.66536661779650e.06 = c(1.00135418967429e-05, -2.55192611862612e-06),
    X2.90489246146993e.06 = c(7.96504552185188e-06, 2.5434186351749e-06),
    X2.87141820410529e.06 = c(-1.54413478420865e-05, -1.11644018406679e-05),
    X2.56314587580490e.05 = c(-1.94447352582406e-06, 3.67435372033041e-05),
   X.7.60601818269879e.06 = c(-6.68752612533472e-06, 1.27657871266399e-06),
   X.1.34594220762763e.05 = c(-4.17953174333251e-08, -1.23386720751857e-05),
   X.2.15001400961294e.07 = c(6.00721728647715e-06, 7.13646340528171e-06),
   X.1.17285198404451e.05 = c(3.83719633620426e-06, 1.71629564678597e-07),
   X.1.54864970196788e.06 = c(4.80450149882399e-06, -3.1022840431988e-06),
    X1.89135730592197e.05 = c(9.87415579842255e-06, -1.79188117400196e-05),
    X5.32964167764542e.06 = c(-4.70376237635909e-07, 2.51893387749516e-06),
    X4.43244995250198e.07 = c(1.0219309922545e-05, 7.1017769062106e-06),
    X2.56668975313575e.06 = c(5.17372227887628e-07, -4.64706358163854e-06),
   X.2.61647917657108e.06 = c(1.11552433958726e-05, -5.08993839342632e-06),
   X.1.10449074419179e.06 = c(-1.41092080075192e-06, 8.60276163457461e-07),
   X.8.53779856570475e.07 = c(-1.1803515351785e-06, -2.19032069475975e-05),
   X.4.25706459234213e.06 = c(1.25669345947348e-05, -8.25451131857563e-06),
    X1.85731232740268e.06 = c(5.75872441874311e-06, 8.05467690408029e-06),
   X.6.21677454404996e.06 = c(8.56864136081778e-06, -3.33580366814788e-06),
    X7.12334744909060e.06 = c(-3.49802953190839e-06, -1.42610811442947e-06),
   X.7.94444370411942e.06 = c(3.86513559218812e-06, -1.76823464967204e-06),
   X.1.44893681794139e.06 = c(1.55349238506637e-05, 6.86612603655772e-06),
    X7.83567969261760e.07 = c(-9.49524231723788e-06, -4.93676511305308e-06),
    X7.77482789503562e.06 = c(1.90296558255274e-05, 1.00403272388239e-05),
    X1.32423585307939e.06 = c(1.61403673044447e-05, 1.20735618386193e-05),
   X.1.74850866291137e.05 = c(-6.86460917971327e-06, -6.97113744441234e-06),
    X2.47169919374076e.06 = c(8.68198448097631e-06, 6.32915425887048e-07),
   X.1.00503866781595e.05 = c(-1.7904976527686e-07, 2.74134162127167e-06),
   X.1.04994545365053e.05 = c(-7.07429323314928e-06, 1.50955248084753e-06),
   X.2.88073630135370e.05 = c(2.65217175345702e-05, 1.55840185169033e-05),
    X2.87829995058153e.05 = c(4.01845511642995e-06, -8.62537914943367e-06),
    X4.96626906107303e.06 = c(6.91219656556172e-05, -3.52221730825358e-05),
   X.7.07336538754646e.06 = c(1.31782057510618e-05, 1.23204728052449e-05),
    X4.32353657471891e.05 = c(4.68098369234594e-05, -9.86048869531939e-06),
    X3.22892383262967e.05 = c(3.71117157168615e-05, -5.15849275273863e-05),
   X.1.44393561638087e.05 = c(0.000100668613836015, 1.72545441521136e-05),
   X.4.74893691140329e.05 = c(-1.67479088913672e-05, 2.17681802207746e-06),
   X.1.64446417387276e.06 = c(-1.47017308012108e-05, 5.03295482771137e-07),
   X.1.26056112476723e.05 = c(4.15024254876014e-05, -3.29975849908613e-05),
    X2.93251230495760e.05 = c(2.61283725883012e-05, 1.1956404200145e-05),
   X.5.33141565553974e.07 = c(-2.4511574002658e-05, -1.07507042574282e-05),
    X1.16087545826634e.05 = c(2.04539270092562e-05, 1.57834008074558e-05)
)data.frame(
    X1.44051748238150e.06 = c(7.23163071696294e-06, -8.57721308067518e-06),
   X.4.58098089567796e.06 = c(5.5021138722312e-06, 3.04725792522511e-06),
   X.5.34630366334278e.07 = c(1.99209389430215e-05, 1.75377427291559e-07),
   X.4.66536661779650e.06 = c(1.00135418967429e-05, -2.55192611862612e-06),
    X2.90489246146993e.06 = c(7.96504552185188e-06, 2.5434186351749e-06),
    X2.87141820410529e.06 = c(-1.54413478420865e-05, -1.11644018406679e-05),
    X2.56314587580490e.05 = c(-1.94447352582406e-06, 3.67435372033041e-05),
   X.7.60601818269879e.06 = c(-6.68752612533472e-06, 1.27657871266399e-06),
   X.1.34594220762763e.05 = c(-4.17953174333251e-08, -1.23386720751857e-05),
   X.2.15001400961294e.07 = c(6.00721728647715e-06, 7.13646340528171e-06),
   X.1.17285198404451e.05 = c(3.83719633620426e-06, 1.71629564678597e-07),
   X.1.54864970196788e.06 = c(4.80450149882399e-06, -3.1022840431988e-06),
    X1.89135730592197e.05 = c(9.87415579842255e-06, -1.79188117400196e-05),
    X5.32964167764542e.06 = c(-4.70376237635909e-07, 2.51893387749516e-06),
    X4.43244995250198e.07 = c(1.0219309922545e-05, 7.1017769062106e-06),
    X2.56668975313575e.06 = c(5.17372227887628e-07, -4.64706358163854e-06),
   X.2.61647917657108e.06 = c(1.11552433958726e-05, -5.08993839342632e-06),
   X.1.10449074419179e.06 = c(-1.41092080075192e-06, 8.60276163457461e-07),
   X.8.53779856570475e.07 = c(-1.1803515351785e-06, -2.19032069475975e-05),
   X.4.25706459234213e.06 = c(1.25669345947348e-05, -8.25451131857563e-06),
    X1.85731232740268e.06 = c(5.75872441874311e-06, 8.05467690408029e-06),
   X.6.21677454404996e.06 = c(8.56864136081778e-06, -3.33580366814788e-06),
    X7.12334744909060e.06 = c(-3.49802953190839e-06, -1.42610811442947e-06),
   X.7.94444370411942e.06 = c(3.86513559218812e-06, -1.76823464967204e-06),
   X.1.44893681794139e.06 = c(1.55349238506637e-05, 6.86612603655772e-06),
    X7.83567969261760e.07 = c(-9.49524231723788e-06, -4.93676511305308e-06),
    X7.77482789503562e.06 = c(1.90296558255274e-05, 1.00403272388239e-05),
    X1.32423585307939e.06 = c(1.61403673044447e-05, 1.20735618386193e-05),
   X.1.74850866291137e.05 = c(-6.86460917971327e-06, -6.97113744441234e-06),
    X2.47169919374076e.06 = c(8.68198448097631e-06, 6.32915425887048e-07),
   X.1.00503866781595e.05 = c(-1.7904976527686e-07, 2.74134162127167e-06),
   X.1.04994545365053e.05 = c(-7.07429323314928e-06, 1.50955248084753e-06),
   X.2.88073630135370e.05 = c(2.65217175345702e-05, 1.55840185169033e-05),
    X2.87829995058153e.05 = c(4.01845511642995e-06, -8.62537914943367e-06),
    X4.96626906107303e.06 = c(6.91219656556172e-05, -3.52221730825358e-05),
   X.7.07336538754646e.06 = c(1.31782057510618e-05, 1.23204728052449e-05),
    X4.32353657471891e.05 = c(4.68098369234594e-05, -9.86048869531939e-06),
    X3.22892383262967e.05 = c(3.71117157168615e-05, -5.15849275273863e-05),
   X.1.44393561638087e.05 = c(0.000100668613836015, 1.72545441521136e-05),
   X.4.74893691140329e.05 = c(-1.67479088913672e-05, 2.17681802207746e-06),
   X.1.64446417387276e.06 = c(-1.47017308012108e-05, 5.03295482771137e-07),
   X.1.26056112476723e.05 = c(4.15024254876014e-05, -3.29975849908613e-05),
    X2.93251230495760e.05 = c(2.61283725883012e-05, 1.1956404200145e-05),
   X.5.33141565553974e.07 = c(-2.4511574002658e-05, -1.07507042574282e-05),
    X1.16087545826634e.05 = c(2.04539270092562e-05, 1.57834008074558e-05)
)tribble(
   ~X1.44051748238150e.06, ~X.4.58098089567796e.06, ~X.5.34630366334278e.07, ~X.4.66536661779650e.06, ~X2.90489246146993e.06,  ~X2.87141820410529e.06,  ~X2.56314587580490e.05, ~X.7.60601818269879e.06, ~X.1.34594220762763e.05, ~X.2.15001400961294e.07, ~X.1.17285198404451e.05, ~X.1.54864970196788e.06,  ~X1.89135730592197e.05,  ~X5.32964167764542e.06, ~X4.43244995250198e.07,  ~X2.56668975313575e.06, ~X.2.61647917657108e.06, ~X.1.10449074419179e.06, ~X.8.53779856570475e.07, ~X.4.25706459234213e.06, ~X1.85731232740268e.06, ~X.6.21677454404996e.06,  ~X7.12334744909060e.06, ~X.7.94444370411942e.06, ~X.1.44893681794139e.06,  ~X7.83567969261760e.07, ~X7.77482789503562e.06, ~X1.32423585307939e.06, ~X.1.74850866291137e.05, ~X2.47169919374076e.06, ~X.1.00503866781595e.05, ~X.1.04994545365053e.05, ~X.2.88073630135370e.05,  ~X2.87829995058153e.05,  ~X4.96626906107303e.06, ~X.7.07336538754646e.06,  ~X4.32353657471891e.05,  ~X3.22892383262967e.05, ~X.1.44393561638087e.05, ~X.4.74893691140329e.05, ~X.1.64446417387276e.06, ~X.1.26056112476723e.05, ~X2.93251230495760e.05, ~X.5.33141565553974e.07, ~X1.16087545826634e.05,
     7.23163071696294e-06,     5.5021138722312e-06,    1.99209389430215e-05,    1.00135418967429e-05,   7.96504552185188e-06,   -1.54413478420865e-05,   -1.94447352582406e-06,   -6.68752612533472e-06,   -4.17953174333251e-08,    6.00721728647715e-06,    3.83719633620426e-06,    4.80450149882399e-06,    9.87415579842255e-06,   -4.70376237635909e-07,    1.0219309922545e-05,    5.17372227887628e-07,    1.11552433958726e-05,   -1.41092080075192e-06,    -1.1803515351785e-06,    1.25669345947348e-05,   5.75872441874311e-06,    8.56864136081778e-06,   -3.49802953190839e-06,    3.86513559218812e-06,    1.55349238506637e-05,   -9.49524231723788e-06,   1.90296558255274e-05,   1.61403673044447e-05,   -6.86460917971327e-06,   8.68198448097631e-06,    -1.7904976527686e-07,   -7.07429323314928e-06,    2.65217175345702e-05,    4.01845511642995e-06,    6.91219656556172e-05,    1.31782057510618e-05,    4.68098369234594e-05,    3.71117157168615e-05,    0.000100668613836015,   -1.67479088913672e-05,   -1.47017308012108e-05,    4.15024254876014e-05,   2.61283725883012e-05,    -2.4511574002658e-05,   2.04539270092562e-05,
    -8.57721308067518e-06,    3.04725792522511e-06,    1.75377427291559e-07,   -2.55192611862612e-06,    2.5434186351749e-06,   -1.11644018406679e-05,    3.67435372033041e-05,    1.27657871266399e-06,   -1.23386720751857e-05,    7.13646340528171e-06,    1.71629564678597e-07,    -3.1022840431988e-06,   -1.79188117400196e-05,    2.51893387749516e-06,    7.1017769062106e-06,   -4.64706358163854e-06,   -5.08993839342632e-06,    8.60276163457461e-07,   -2.19032069475975e-05,   -8.25451131857563e-06,   8.05467690408029e-06,   -3.33580366814788e-06,   -1.42610811442947e-06,   -1.76823464967204e-06,    6.86612603655772e-06,   -4.93676511305308e-06,   1.00403272388239e-05,   1.20735618386193e-05,   -6.97113744441234e-06,   6.32915425887048e-07,    2.74134162127167e-06,    1.50955248084753e-06,    1.55840185169033e-05,   -8.62537914943367e-06,   -3.52221730825358e-05,    1.23204728052449e-05,   -9.86048869531939e-06,   -5.15849275273863e-05,    1.72545441521136e-05,    2.17681802207746e-06,    5.03295482771137e-07,   -3.29975849908613e-05,    1.1956404200145e-05,   -1.07507042574282e-05,   1.57834008074558e-05
  )
对数据进行预处理
```{r}
#install.packages("prospectr")
library(prospectr)
plot(y = one_wave$oxyHb, x = one_wave$`Time(sec)`, type = "l")
move_noisy <- movav(one_wave, w = 1)
lines(x = one_wave$oxyHb , move_noisy[1,], col = "red")
```

